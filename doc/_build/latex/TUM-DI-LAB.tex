%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
 \ifdefined\DeclareUnicodeCharacterAsOptional
  \DeclareUnicodeCharacter{"00A0}{\nobreakspace}
  \DeclareUnicodeCharacter{"2500}{\sphinxunichar{2500}}
  \DeclareUnicodeCharacter{"2502}{\sphinxunichar{2502}}
  \DeclareUnicodeCharacter{"2514}{\sphinxunichar{2514}}
  \DeclareUnicodeCharacter{"251C}{\sphinxunichar{251C}}
  \DeclareUnicodeCharacter{"2572}{\textbackslash}
 \else
  \DeclareUnicodeCharacter{00A0}{\nobreakspace}
  \DeclareUnicodeCharacter{2500}{\sphinxunichar{2500}}
  \DeclareUnicodeCharacter{2502}{\sphinxunichar{2502}}
  \DeclareUnicodeCharacter{2514}{\sphinxunichar{2514}}
  \DeclareUnicodeCharacter{251C}{\sphinxunichar{251C}}
  \DeclareUnicodeCharacter{2572}{\textbackslash}
 \fi
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}
\usepackage{times}
\usepackage[Bjarne]{fncychap}
\usepackage{sphinx}

\usepackage{geometry}

% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}

\addto\captionsenglish{\renewcommand{\figurename}{Fig.}}
\addto\captionsenglish{\renewcommand{\tablename}{Table}}
\addto\captionsenglish{\renewcommand{\literalblockname}{Listing}}

\addto\captionsenglish{\renewcommand{\literalblockcontinuedname}{continued from previous page}}
\addto\captionsenglish{\renewcommand{\literalblockcontinuesname}{continues on next page}}

\addto\extrasenglish{\def\pageautorefname{page}}

\setcounter{tocdepth}{1}


% Jupyter Notebook prompt colors
\definecolor{nbsphinxin}{HTML}{303F9F}
\definecolor{nbsphinxout}{HTML}{D84315}
% ANSI colors for output streams and traceback highlighting
\definecolor{ansi-black}{HTML}{3E424D}
\definecolor{ansi-black-intense}{HTML}{282C36}
\definecolor{ansi-red}{HTML}{E75C58}
\definecolor{ansi-red-intense}{HTML}{B22B31}
\definecolor{ansi-green}{HTML}{00A250}
\definecolor{ansi-green-intense}{HTML}{007427}
\definecolor{ansi-yellow}{HTML}{DDB62B}
\definecolor{ansi-yellow-intense}{HTML}{B27D12}
\definecolor{ansi-blue}{HTML}{208FFB}
\definecolor{ansi-blue-intense}{HTML}{0065CA}
\definecolor{ansi-magenta}{HTML}{D160C4}
\definecolor{ansi-magenta-intense}{HTML}{A03196}
\definecolor{ansi-cyan}{HTML}{60C6C8}
\definecolor{ansi-cyan-intense}{HTML}{258F8F}
\definecolor{ansi-white}{HTML}{C5C1B4}
\definecolor{ansi-white-intense}{HTML}{A1A6B2}
\definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
\definecolor{ansi-default-inverse-bg}{HTML}{000000}

% Define "notice" environment, which was removed in Sphinx 1.7.
% At some point, "notice" should be replaced by "sphinxadmonition",
% which is available since Sphinx 1.5.
\makeatletter
\@ifundefined{notice}{%
\newenvironment{notice}{\begin{sphinxadmonition}}{\end{sphinxadmonition}}%
}{}
\makeatother



\title{TUM-DI-LAB Documentation}
\date{Jun 24, 2018}
\release{}
\author{K. Harsha, A. Grundner, K. Wang}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{}
\makeindex

\begin{document}

\maketitle
\sphinxtableofcontents
\phantomsection\label{\detokenize{index::doc}}



\chapter{Introduction to Gaussian process}
\label{\detokenize{report/1-intro_to_gp:introduction-to-gaussian-process}}\label{\detokenize{report/1-intro_to_gp::doc}}
Define Gaussian processes and properties


\chapter{Simple example of a Gaussian process}
\label{\detokenize{report/2-simple_gp:Simple-example-of-a-Gaussian-process}}\label{\detokenize{report/2-simple_gp::doc}}
The following example illustrates how we move from process to
distribution and also shows that the Gaussian process defines a
distribution over functions.

\(f \sim \mathcal{GP}(m,k)\)

\(m(x) = \frac{x^2}{4}\)

\(k(x,x') = exp(-\frac{1}{2}(x-x')^2)\)

\(y = f + \epsilon\)

\(\epsilon \sim \mathcal{N}(0, \sigma^2)\)

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [1]: }\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
        \PYG{k+kn}{import} \PYG{n+nn}{scipy} \PYG{k}{as} \PYG{n+nn}{sp}
        \PYG{k+kn}{import} \PYG{n+nn}{matplotlib}\PYG{n+nn}{.}\PYG{n+nn}{pyplot} \PYG{k}{as} \PYG{n+nn}{plt}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [2]: }\PYG{n}{x} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{5}\PYG{p}{,}\PYG{l+m+mi}{5}\PYG{p}{,}\PYG{l+m+mf}{0.2}\PYG{p}{)}
        \PYG{n}{n} \PYG{o}{=} \PYG{n}{x}\PYG{o}{.}\PYG{n}{size}
        \PYG{n}{s} \PYG{o}{=} \PYG{l+m+mf}{1e\PYGZhy{}9}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [3]: }\PYG{n}{m} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{square}\PYG{p}{(}\PYG{n}{x}\PYG{p}{)} \PYG{o}{*} \PYG{l+m+mf}{0.25}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [4]: }\PYG{n}{a} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{repeat}\PYG{p}{(}\PYG{n}{x}\PYG{p}{,} \PYG{n}{n}\PYG{p}{)}\PYG{o}{.}\PYG{n}{reshape}\PYG{p}{(}\PYG{n}{n}\PYG{p}{,} \PYG{n}{n}\PYG{p}{)}
        \PYG{n}{k} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.5}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{square}\PYG{p}{(}\PYG{n}{a} \PYG{o}{\PYGZhy{}} \PYG{n}{a}\PYG{o}{.}\PYG{n}{transpose}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{n}{s}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{identity}\PYG{p}{(}\PYG{n}{n}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [5]: }\PYG{n}{r} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{multivariate\PYGZus{}normal}\PYG{p}{(}\PYG{n}{m}\PYG{p}{,} \PYG{n}{k}\PYG{p}{,} \PYG{l+m+mi}{1}\PYG{p}{)}
        \PYG{n}{y} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{reshape}\PYG{p}{(}\PYG{n}{r}\PYG{p}{,} \PYG{n}{n}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [6]: }\PYG{n}{plt}\PYG{o}{.}\PYG{n}{plot}\PYG{p}{(}\PYG{n}{x}\PYG{p}{,}\PYG{n}{y}\PYG{p}{)}
        \PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{Verbatim}

\noindent\sphinxincludegraphics{{report_2-simple_gp_6_0}.png}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [ ]: }
\end{Verbatim}


\chapter{Linear operators on GPs}
\label{\detokenize{report/3-linear_op_gp:linear-operators-on-gps}}\label{\detokenize{report/3-linear_op_gp::doc}}
Description of covariance transformations


\chapter{Parameter estimation for a linear operator using Gaussian processes}
\label{\detokenize{report/4-par_est:Parameter-estimation-for-a-linear-operator-using-Gaussian-processes}}\label{\detokenize{report/4-par_est::doc}}
Assumptions about the linear operator:

\(\mathcal{L}_x^\phi u(x) = f(x)\)

\(u(x) \sim \mathcal{GP}(0, k_{uu}(x,x',\theta))\)

\(f(x) \sim \mathcal{GP}(0, k_{ff}(x,x',\theta,\phi))\)

\(y_u = u(X_u) + \epsilon_u; \epsilon_u \sim \mathcal{N}(0, \sigma_u^2I)\)

\(y_f = f(X_f) + \epsilon_f; \epsilon_f \sim \mathcal{N}(0, \sigma_f^2I)\)

Taking a simple operator as example:

\(\mathcal{L}_x^\phi := \phi \cdot + \frac{d}{dx}\cdot\)

\(u(x) = sin(x)\)

\(f(x) = \phi sin(x) + cos(x)\)

Problem at hand:

Given \(\{X_u, y_u\}\) and \(\{X_f, y_f\}\), estimate
\(\phi\).


\section{step 1: simulate data}
\label{\detokenize{report/4-par_est:step-1:-simulate-data}}
Use \(\phi = 2\)

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [2]: }\PYG{n}{x\PYGZus{}u} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{pi}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{)}
        \PYG{n}{y\PYGZus{}u} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{sin}\PYG{p}{(}\PYG{n}{x\PYGZus{}u}\PYG{p}{)}
        \PYG{n}{x\PYGZus{}f} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linspace}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{,}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{pi}\PYG{p}{,} \PYG{l+m+mi}{10}\PYG{p}{)}
        \PYG{n}{y\PYGZus{}f} \PYG{o}{=} \PYG{l+m+mf}{2.0}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{sin}\PYG{p}{(}\PYG{n}{x\PYGZus{}f}\PYG{p}{)} \PYG{o}{+} \PYG{n}{np}\PYG{o}{.}\PYG{n}{cos}\PYG{p}{(}\PYG{n}{x\PYGZus{}f}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [4]: }\PYG{n}{plt}\PYG{o}{.}\PYG{n}{show}\PYG{p}{(}\PYG{p}{)}
\end{Verbatim}

\noindent\sphinxincludegraphics{{report_4-par_est_4_0}.png}


\section{step 2: create covariance matrix}
\label{\detokenize{report/4-par_est:step-2:-create-covariance-matrix}}
This step uses information about \(\mathcal{L}_x^\phi\) but not
about \(u(x)\) or \(f(x)\).

\(k_{uu}(x_i, x_j; \theta) = \theta exp(-\frac{1}{2}(x_i-x_j)^2)\)

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [5]: }\PYG{n}{x\PYGZus{}i}\PYG{p}{,} \PYG{n}{x\PYGZus{}j}\PYG{p}{,} \PYG{n}{theta}\PYG{p}{,} \PYG{n}{phi} \PYG{o}{=} \PYG{n}{sp}\PYG{o}{.}\PYG{n}{symbols}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{x\PYGZus{}i x\PYGZus{}j theta phi}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
        \PYG{n}{kuu\PYGZus{}sym} \PYG{o}{=} \PYG{n}{theta}\PYG{o}{*}\PYG{n}{sp}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{o}{/}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{o}{*}\PYG{p}{(}\PYG{p}{(}\PYG{n}{x\PYGZus{}i} \PYG{o}{\PYGZhy{}} \PYG{n}{x\PYGZus{}j}\PYG{p}{)}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{)}
        \PYG{n}{kuu\PYGZus{}fn} \PYG{o}{=} \PYG{n}{sp}\PYG{o}{.}\PYG{n}{lambdify}\PYG{p}{(}\PYG{p}{(}\PYG{n}{x\PYGZus{}i}\PYG{p}{,} \PYG{n}{x\PYGZus{}j}\PYG{p}{,} \PYG{n}{theta}\PYG{p}{)}\PYG{p}{,} \PYG{n}{kuu\PYGZus{}sym}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{numpy}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
        \PYG{k}{def} \PYG{n+nf}{kuu}\PYG{p}{(}\PYG{n}{x}\PYG{p}{,} \PYG{n}{theta}\PYG{p}{)}\PYG{p}{:}
            \PYG{n}{k} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{p}{(}\PYG{n}{x}\PYG{o}{.}\PYG{n}{size}\PYG{p}{,} \PYG{n}{x}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{)}
            \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{x}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{:}
                \PYG{k}{for} \PYG{n}{j} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{x}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{:}
                    \PYG{n}{k}\PYG{p}{[}\PYG{n}{i}\PYG{p}{,}\PYG{n}{j}\PYG{p}{]} \PYG{o}{=} \PYG{n}{kuu\PYGZus{}fn}\PYG{p}{(}\PYG{n}{x}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,} \PYG{n}{x}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]}\PYG{p}{,} \PYG{n}{theta}\PYG{p}{)}
            \PYG{k}{return} \PYG{n}{k}
\end{Verbatim}

\(k_{ff}(x_i,x_j;\theta,\phi) \\ = \mathcal{L}_{x_i}^\phi \mathcal{L}_{x_j}^\phi k_{uu}(x_i, x_j; \theta) \\ = \mathcal{L}_{x_i}^\phi \left( \phi k_{uu} + \frac{\partial}{\partial x_j}k_{uu} \right) \\ = \phi^2 k_{uu} + \phi \frac{\partial}{\partial x_j}k_{uu} + \phi \frac{\partial}{\partial x_i}k_{uu} + \frac{\partial}{\partial x_i}\frac{\partial}{\partial x_j}k_{uu}\)

More explicit calculations follow:

\(\mathcal{L}_{x_i}^\phi \mathcal{L}_{x_j}^\phi \left[ \theta exp(-\frac{1}{2}(x_i-x_j)^2) \right] \\ = \mathcal{L}_{x_i}^\phi \left[ \theta exp(-\frac{1}{2}(x_i-x_j)^2)\left(\phi + (-\frac{1}{2})2(x_i-x_j)(-1) \right) \right] \\ = \mathcal{L}_{x_i}^\phi \left[\theta exp(-\frac{1}{2}(x_i-x_j)^2)(\phi + x_i - x_j) \right] \\ = \phi \theta exp(-\frac{1}{2}(x_i-x_j)^2)(\phi+x_i-x_j) + \theta exp(-\frac{1}{2}(x_i-x_j)^2)\left[ -\frac{1}{2}2(x_i-x_j)(\phi+x_i-x_j) + 1 \right] \\ = \theta exp(-\frac{1}{2}(x_i-x_j)^2)\left[ \phi^2 - (x_i-x_j)^2 + 1 \right]\)

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [6]: }\PYG{n}{kff\PYGZus{}sym} \PYG{o}{=} \PYG{n}{phi}\PYG{o}{*}\PYG{o}{*}\PYG{l+m+mi}{2}\PYG{o}{*}\PYG{n}{kuu\PYGZus{}sym} \PYG{o}{+} \PYG{n}{phi}\PYG{o}{*}\PYG{n}{sp}\PYG{o}{.}\PYG{n}{diff}\PYG{p}{(}\PYG{n}{kuu\PYGZus{}sym}\PYG{p}{,} \PYG{n}{x\PYGZus{}j}\PYG{p}{)} \PYG{o}{+} \PYG{n}{phi}\PYG{o}{*}\PYG{n}{sp}\PYG{o}{.}\PYG{n}{diff}\PYG{p}{(}\PYG{n}{kuu\PYGZus{}sym}\PYG{p}{,} \PYG{n}{x\PYGZus{}i}\PYG{p}{)} \PYG{o}{+} \PYG{n}{sp}\PYG{o}{.}\PYG{n}{diff}\PYG{p}{(}\PYG{n}{kuu\PYGZus{}sym}\PYG{p}{,} \PYG{n}{x\PYGZus{}j}\PYG{p}{,} \PYG{n}{x\PYGZus{}i}\PYG{p}{)}
        \PYG{n}{kff\PYGZus{}fn} \PYG{o}{=} \PYG{n}{sp}\PYG{o}{.}\PYG{n}{lambdify}\PYG{p}{(}\PYG{p}{(}\PYG{n}{x\PYGZus{}i}\PYG{p}{,} \PYG{n}{x\PYGZus{}j}\PYG{p}{,} \PYG{n}{theta}\PYG{p}{,} \PYG{n}{phi}\PYG{p}{)}\PYG{p}{,} \PYG{n}{kff\PYGZus{}sym}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{numpy}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
        \PYG{k}{def} \PYG{n+nf}{kff}\PYG{p}{(}\PYG{n}{x}\PYG{p}{,} \PYG{n}{theta}\PYG{p}{,} \PYG{n}{phi}\PYG{p}{)}\PYG{p}{:}
            \PYG{n}{k} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{p}{(}\PYG{n}{x}\PYG{o}{.}\PYG{n}{size}\PYG{p}{,} \PYG{n}{x}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{)}
            \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{x}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{:}
                \PYG{k}{for} \PYG{n}{j} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{x}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{:}
                    \PYG{n}{k}\PYG{p}{[}\PYG{n}{i}\PYG{p}{,}\PYG{n}{j}\PYG{p}{]} \PYG{o}{=} \PYG{n}{kff\PYGZus{}fn}\PYG{p}{(}\PYG{n}{x}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,} \PYG{n}{x}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]}\PYG{p}{,} \PYG{n}{theta}\PYG{p}{,} \PYG{n}{phi}\PYG{p}{)}
            \PYG{k}{return} \PYG{n}{k}
\end{Verbatim}

\(k_{fu}(x_i,x_j;\theta,\phi) \\ = \mathcal{L}_{x_i}^\phi k_{uu}(x_i, x_j; \theta) \\ = \phi k_{uu} + \frac{\partial}{\partial x_i}k_{uu} \\ = \mathcal{L}_{x_i}^\phi \left[ \theta exp(-\frac{1}{2}(x_i-x_j)^2) \right] \\ = \theta exp(-\frac{1}{2}(x_i-x_j)^2) \left[ (-\frac{1}{2})2(x_i-x_j) + \phi \right] \\ = \theta exp(-\frac{1}{2}(x_i-x_j)^2)(\phi-x_i+x_j)\)

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [7]: }\PYG{n}{kfu\PYGZus{}sym} \PYG{o}{=} \PYG{n}{phi}\PYG{o}{*}\PYG{n}{kuu\PYGZus{}sym} \PYG{o}{+} \PYG{n}{sp}\PYG{o}{.}\PYG{n}{diff}\PYG{p}{(}\PYG{n}{kuu\PYGZus{}sym}\PYG{p}{,} \PYG{n}{x\PYGZus{}i}\PYG{p}{)}
        \PYG{n}{kfu\PYGZus{}fn} \PYG{o}{=} \PYG{n}{sp}\PYG{o}{.}\PYG{n}{lambdify}\PYG{p}{(}\PYG{p}{(}\PYG{n}{x\PYGZus{}i}\PYG{p}{,} \PYG{n}{x\PYGZus{}j}\PYG{p}{,} \PYG{n}{theta}\PYG{p}{,} \PYG{n}{phi}\PYG{p}{)}\PYG{p}{,} \PYG{n}{kfu\PYGZus{}sym}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{numpy}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
        \PYG{k}{def} \PYG{n+nf}{kfu}\PYG{p}{(}\PYG{n}{x1}\PYG{p}{,} \PYG{n}{x2}\PYG{p}{,} \PYG{n}{theta}\PYG{p}{,} \PYG{n}{phi}\PYG{p}{)}\PYG{p}{:}
            \PYG{n}{k} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{zeros}\PYG{p}{(}\PYG{p}{(}\PYG{n}{x1}\PYG{o}{.}\PYG{n}{size}\PYG{p}{,} \PYG{n}{x2}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{)}
            \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{x1}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{:}
                \PYG{k}{for} \PYG{n}{j} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{x2}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{:}
                    \PYG{n}{k}\PYG{p}{[}\PYG{n}{i}\PYG{p}{,}\PYG{n}{j}\PYG{p}{]} \PYG{o}{=} \PYG{n}{kfu\PYGZus{}fn}\PYG{p}{(}\PYG{n}{x1}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]}\PYG{p}{,} \PYG{n}{x2}\PYG{p}{[}\PYG{n}{j}\PYG{p}{]}\PYG{p}{,} \PYG{n}{theta}\PYG{p}{,} \PYG{n}{phi}\PYG{p}{)}
            \PYG{k}{return} \PYG{n}{k}
\end{Verbatim}

\(k_{uf}(x_i,x_j;\theta,\phi) \\ = \mathcal{L}_{x_j}^\phi k_{uu}(x_i, x_j; \theta) \\ = \mathcal{L}_{x_j}^\phi \left[ \theta exp(-\frac{1}{2}(x_i-x_j)^2) \right] \\ = \theta exp(-\frac{1}{2}(x_i-x_j)^2) \left[ (-\frac{1}{2})2(x_i-x_j)(-1) + \phi \right]\\ = \theta exp(-\frac{1}{2}(x_i-x_j)^2)(\phi+x_i-x_j)\)

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [8]: }\PYG{k}{def} \PYG{n+nf}{kuf}\PYG{p}{(}\PYG{n}{x1}\PYG{p}{,} \PYG{n}{x2}\PYG{p}{,} \PYG{n}{theta}\PYG{p}{,} \PYG{n}{phi}\PYG{p}{)}\PYG{p}{:}
            \PYG{k}{return} \PYG{n}{kfu}\PYG{p}{(}\PYG{n}{x1}\PYG{p}{,}\PYG{n}{x2}\PYG{p}{,}\PYG{n}{theta}\PYG{p}{,}\PYG{n}{phi}\PYG{p}{)}\PYG{o}{.}\PYG{n}{T}
\end{Verbatim}


\section{step 3: define negative log marginal likelihood}
\label{\detokenize{report/4-par_est:step-3:-define-negative-log-marginal-likelihood}}
\(K = \begin{bmatrix} k_{uu}(X_u, X_u; \theta) + \sigma_u^2I & k_{uf}(X_u, X_f; \theta, \phi) \\ k_{fu}(X_f, X_u; \theta, \phi) & k_{ff}(X_f, X_f; \theta, \phi) + \sigma_f^2I \end{bmatrix}\)

For simplicity, assume \(\sigma_u = \sigma_f\).

\(\mathcal{NLML} = \frac{1}{2} \left[ log|K| + y^TK^{-1}y + Nlog(2\pi) \right]\)

where \(y = \begin{bmatrix} y_u \\ y_f \end{bmatrix}\)

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [9]: }\PYG{k}{def} \PYG{n+nf}{nlml}\PYG{p}{(}\PYG{n}{params}\PYG{p}{,} \PYG{n}{x1}\PYG{p}{,} \PYG{n}{x2}\PYG{p}{,} \PYG{n}{y1}\PYG{p}{,} \PYG{n}{y2}\PYG{p}{,} \PYG{n}{s}\PYG{p}{)}\PYG{p}{:}
            \PYG{n}{params} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{n}{params}\PYG{p}{)}
            \PYG{n}{K} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{block}\PYG{p}{(}\PYG{p}{[}
                \PYG{p}{[}\PYG{n}{kuu}\PYG{p}{(}\PYG{n}{x1}\PYG{p}{,} \PYG{n}{params}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{)} \PYG{o}{+} \PYG{n}{s}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{identity}\PYG{p}{(}\PYG{n}{x1}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{,} \PYG{n}{kuf}\PYG{p}{(}\PYG{n}{x1}\PYG{p}{,} \PYG{n}{x2}\PYG{p}{,} \PYG{n}{params}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{params}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}\PYG{p}{]}\PYG{p}{,}
                \PYG{p}{[}\PYG{n}{kfu}\PYG{p}{(}\PYG{n}{x1}\PYG{p}{,} \PYG{n}{x2}\PYG{p}{,} \PYG{n}{params}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{params}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} \PYG{n}{kff}\PYG{p}{(}\PYG{n}{x2}\PYG{p}{,} \PYG{n}{params}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{params}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)} \PYG{o}{+} \PYG{n}{s}\PYG{o}{*}\PYG{n}{np}\PYG{o}{.}\PYG{n}{identity}\PYG{p}{(}\PYG{n}{x2}\PYG{o}{.}\PYG{n}{size}\PYG{p}{)}\PYG{p}{]}
            \PYG{p}{]}\PYG{p}{)}
            \PYG{n}{y} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{concatenate}\PYG{p}{(}\PYG{p}{(}\PYG{n}{y1}\PYG{p}{,} \PYG{n}{y2}\PYG{p}{)}\PYG{p}{)}
            \PYG{n}{val} \PYG{o}{=} \PYG{l+m+mf}{0.5}\PYG{o}{*}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{log}\PYG{p}{(}\PYG{n+nb}{abs}\PYG{p}{(}\PYG{n}{np}\PYG{o}{.}\PYG{n}{linalg}\PYG{o}{.}\PYG{n}{det}\PYG{p}{(}\PYG{n}{K}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)} \PYG{o}{+} \PYG{n}{np}\PYG{o}{.}\PYG{n}{mat}\PYG{p}{(}\PYG{n}{y}\PYG{p}{)} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{linalg}\PYG{o}{.}\PYG{n}{inv}\PYG{p}{(}\PYG{n}{K}\PYG{p}{)} \PYG{o}{*} \PYG{n}{np}\PYG{o}{.}\PYG{n}{mat}\PYG{p}{(}\PYG{n}{y}\PYG{p}{)}\PYG{o}{.}\PYG{n}{T}\PYG{p}{)}
            \PYG{k}{return} \PYG{n}{val}\PYG{o}{.}\PYG{n}{item}\PYG{p}{(}\PYG{l+m+mi}{0}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [10]: }\PYG{n}{nlml}\PYG{p}{(}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,} \PYG{n}{x\PYGZus{}u}\PYG{p}{,} \PYG{n}{x\PYGZus{}f}\PYG{p}{,} \PYG{n}{y\PYGZus{}u}\PYG{p}{,} \PYG{n}{y\PYGZus{}f}\PYG{p}{,} \PYG{l+m+mf}{1e\PYGZhy{}6}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[10]: }1121127.9918793645
\end{Verbatim}


\section{step 4: optimise hyperparameters}
\label{\detokenize{report/4-par_est:step-4:-optimise-hyperparameters}}
\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [11]: }\PYG{n}{m} \PYG{o}{=} \PYG{n}{minimize}\PYG{p}{(}\PYG{n}{nlml}\PYG{p}{,} \PYG{n}{np}\PYG{o}{.}\PYG{n}{random}\PYG{o}{.}\PYG{n}{rand}\PYG{p}{(}\PYG{l+m+mi}{2}\PYG{p}{)}\PYG{p}{,} \PYG{n}{args}\PYG{o}{=}\PYG{p}{(}\PYG{n}{x\PYGZus{}u}\PYG{p}{,} \PYG{n}{x\PYGZus{}f}\PYG{p}{,} \PYG{n}{y\PYGZus{}u}\PYG{p}{,} \PYG{n}{y\PYGZus{}f}\PYG{p}{,} \PYG{l+m+mf}{1e\PYGZhy{}6}\PYG{p}{)}\PYG{p}{,} \PYG{n}{method}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Nelder\PYGZhy{}Mead}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [12]: }\PYG{n}{m}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[12]: }final\PYGZus{}simplex: (array([[\PYGZhy{}1.45260947,  0.69314849],
                [\PYGZhy{}1.45254371,  0.69314842],
                [\PYGZhy{}1.45254438,  0.69314847]]), array([\PYGZhy{}54.80042072, \PYGZhy{}54.80042072, \PYGZhy{}54.8004207 ]))
                    fun: \PYGZhy{}54.80042072210781
                message: \PYGZsq{}Optimization terminated successfully.\PYGZsq{}
                   nfev: 131
                    nit: 68
                 status: 0
                success: True
                      x: array([\PYGZhy{}1.45260947,  0.69314849])
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxin}{In [13]: }\PYG{n}{np}\PYG{o}{.}\PYG{n}{exp}\PYG{p}{(}\PYG{n}{m}\PYG{o}{.}\PYG{n}{x}\PYG{p}{)}
\end{Verbatim}

\fvset{hllines={, ,}}%
\begin{Verbatim}[commandchars=\\\{\}]
\textcolor{nbsphinxout}{Out[13]: }array([0.23395898, 2.00000261])
\end{Verbatim}

Limitations of available tools

Linear PDEs

Non-linear PDEs

PDEs without discretization

Results and Analysis

Conclusion



\renewcommand{\indexname}{Index}
\printindex
\end{document}